\documentclass[a4paper, 12pt]{article}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage[top=2cm,bottom=3cm,left=2cm,right=2cm]{geometry}
\usepackage{amssymb, amsmath} 
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{stmaryrd} 

\pagestyle{fancy}
\usepackage{lastpage}
\renewcommand\headrulewidth{1pt}
\fancyhead[C]{\Large \textbf{Convex optimization - Homework 3 - LAPASSAT Louis}}
\fancyfoot[C]{\thepage/\pageref{LastPage}}
\fancyfoot[L]{louislapassat@orange.fr}
%\fancyfoot[R]{Mines ParisTech}


\begin{document}
	
	We consider the following problem (LASSO):
	
	$$\min_w \frac{1}{2}||Xw - y||_2^2 + \lambda||w||_1,$$
	
	where $w\in \mathbb{R}^d$, $X=(x_1, .., x_n) \in \mathbb{R}^{n \times d}$, $y=(y_1, .., y_n) \in \mathbb{R}^n$ and $\lambda > 0$.
	
	\bigbreak
	
	\underline{Question $1$:}
	
	\smallbreak
	
	We first rewrite (LASSO) problem like so:
	
	$$\begin{aligned}
	\min_{w,z} \quad & \frac{1}{2}||Xw - y||_2^2 + \lambda||z||_1\\
	\textrm{s.t.} \quad & z = w\\
	\end{aligned}$$
	
	Hence the Lagrangian is:
	
	$$ L(w,z,\nu) = \frac{1}{2}||Xw - y||_2^2 + \lambda||z||_1 + \nu^T(w-z),$$
	
	where $\nu \in \mathbb{R}^d.$ So the dual function is:
	
	$$ g(\nu) = \inf_{w,z} \bigg( \frac{1}{2}||Xw - y||_2^2 + \nu^Tw\bigg) + \bigg(\lambda||z||_1 -\nu^Tz\bigg).$$
	
	As the first part is independent of $z$, and the second part is independent of $w$, the minimizers can be found by minimizing both part separately, over $w$ and $z$ respectively. Starting with $z$ we have:
	
	$$ \inf_{z} \lambda||z||_1 -\nu^Tz \Longleftrightarrow -\sup_{z} \nu^Tz - \lambda||z||_1 = \begin{cases}
	 0 & \mbox{if } ||\nu||_{\infty} \leq \lambda \\
	 -\infty & \text{otherwise}
	\end{cases}.$$
	
	Now for $w$ we have:
	
	$$ \inf_w  \frac{1}{2}||Xw - y||_2^2 + \nu^Tw.$$
	
	Since the function is convex, we can just consider derivative with respect to $w$ in order to get the infimum.
	
	$$ \nabla_w L(w,z,\nu) = X^T(Xw-y) + \nu \text{ and } \nabla_w^2 L(x,z,\nu) = X^TX.$$
	
	Since $X^TX \geq 0$ we know that a stationary point is a global minima. Therefore $w^*$ solves:
	
	$$  \nabla_w L(w,z,\nu)\rvert_{w^*} = 0 \Longleftrightarrow X^TXw^* = X^Ty - \nu,$$
	
	and if $X$ has independent columns: $w^* = (X^TX)^{-1}(X^Ty-\nu).$ Finally the dual problem is given by:
	
	$$ \max_{\nu} g(\nu) \Longleftrightarrow 
	\begin{aligned}
	\max_{\nu} \quad & \frac{1}{2}||Xw^* - y||_2^2 + \nu^Tw^*\\
	\textrm{s.t.} \quad & ||\nu||_{\infty} \leq \lambda\\
	\end{aligned} \quad (D)$$
	
	Now we want to simplify and transform $(D)$ into a general Quadratic Problem $(QP)$. To do so let's first replace $w^*$, then drop all terms that do not depend on $\nu$ (the $\arg\max$ remain the same):
	
	$$\frac{1}{2}||Xw^* - y||_2^2 + \nu^Tw^* \Longrightarrow -\frac{1}{2}\nu^T(X^TX)^{-1}\nu + \nu^T(X^TX)^{-1}X^Ty.$$
	
	\newpage
	
	So $(D)$ is equivalent to the following minimization problem:
	
	$$\begin{aligned}
	\min_{\nu} \quad & \frac{1}{2}\nu^T(X^TX)^{-1}\nu - \nu^T(X^TX)^{-1}X^Ty\\
	\textrm{s.t.} \quad & ||\nu||_{\infty} \leq \lambda\\
	\end{aligned} \quad.$$
	
	Now we only have to transform the constraints:
	
	$$||\nu||_{\infty} \leq \lambda \Longleftrightarrow -\lambda \leq \nu_i \leq \lambda \quad \forall i=1,..,d \Longleftrightarrow \begin{bmatrix} I_d \\ -I_d \end{bmatrix}\nu \leq \lambda \begin{bmatrix} 1 \\ \vdots \\ 1 \end{bmatrix},$$
	
	where $I_d$ is the $d\times d$ identity matrix. Finally the problem can be rewritten like so:
	
	$$\begin{aligned}
	\min_{v} \quad & v^TQv + p^Tv\\
	\textrm{s.t.} \quad & Av \leq b\\
	\end{aligned} \quad (QP),$$
	
	where $Q=\frac{1}{2}(X^TX)^{-1}$, $p = -(X^TX)^{-1}X^Ty$, $A=\begin{bmatrix} I_d \\ -I_d \end{bmatrix}$ and $b=[\lambda,..,\lambda]^T \in \mathbb{R}^{2d}$.
	
	
\end{document}